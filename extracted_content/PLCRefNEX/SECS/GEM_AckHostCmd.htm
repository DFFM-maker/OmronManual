
<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
 <meta name="generator" content="Adobe RoboHelp 11">
<title>GEM_AckHostCmd</title>
<link rel="StyleSheet" href="SECS.css" type="text/css">
<style title="hcp" type="text/css">
<!--
table.hcp1 { padding-left:4.00pt;
padding-top:3.00pt;
padding-right:4.00pt;
padding-bottom:1.00pt; }
th.hcp2 { border-top:solid 1px #000000;
border-right:solid 1px #000000;
border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
th.hcp3 { border-top:solid 1px #000000;
border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
td.hcp4 { border-right:solid 1px #000000;
border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
div.hcp5 { text-align:center; }
td.hcp6 { border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
table.hcp7 { padding-top:5.00pt;
padding-right:4.00pt;
padding-bottom:1.00pt; }
td.hcp8 { vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
table.hcp9 { margin-left:0.00pt;
margin-bottom:3.50pt;
margin-top:6.00pt; }
th.hcp10 { border-right:solid 1px #000000;
border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
th.hcp11 { border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
span.hcp12 { word-spacing:normal;
font:6.0pt 'Times New Roman'; }
div.hcp13 { text-align:left; }
table.hcp14 { padding-left:4.00pt;
padding-top:3.00pt;
padding-right:4.00pt;
padding-bottom:1.00pt;
margin-left:42.52pt; }
span.hcp15 { font-family:Symbol; }
span.hcp16 { font-style:italic; }
table.hcp17 { padding-top:6.00pt;
padding-right:4.00pt;
padding-bottom:1.00pt;
margin-left:31.18pt; }
td.hcp18 { border-left:solid 7px #000000;
border-bottom:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
td.hcp19 { border-right:solid 1px #000000;
vertical-align:top;
padding-left:6.00pt;
padding-top:3.00pt;
padding-right:6.00pt;
padding-bottom:3.00pt; }
-->
</style>
</head>

<body>
<script type="text/javascript" src="../../ehlpdhtm.js" language="JavaScript1.2"></script>

<p class="Title">GEM_AckHostCmd</p>
<p class="FM_body1">The GEM_AckHostCmd instruction sends the execution 
 accept/reject result in reply to an execution request for a host command.</p>

<table cellspacing="0" width="661" class="hcp1">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="94" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Instruction</p></th>
		<th width="94" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="43" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">FB/</p>
		<p class="FM_tabletitlec9pt">FUN</p></th>
		<th width="236" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Graphic 
		 expression</p></th>
		<th width="194" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">ST expression</p></th>
	</tr>
	<tr style="height: 133.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM_AckHostCmd</p></td>
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Acknowledge Host Command</p></td>
		<td width="43" class="hcp4"><p 
			 class="FM_tablebody1c9pt">FB</p></td>
		<td style="border-right: solid 1px #000000; border-bottom: solid 1px #000000;" 
			 width="236"><div class="hcp5">
			<img alt="Appendix_A00056.jpg" id="image23" src="Appendix_A00056.jpg" width="185" height="123" border="0"> 
		</div>
		<p class="FM_fig">&#160;</p></td>
		<td width="194" class="hcp6"><p class="FM_tablebody1c9pt">GEM_AckHostCmd_instance(</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Execute,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;RCMD,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;HCACK,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;CPErrorNum,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Done,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Busy,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Error,</p>
		<p class="FM_tablebody1c9pt">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ErrorID);</p></td>
	</tr>
</table>

<p class="FM_CRhead3">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Variables</p></td>
	</tr>
</table>

<p class="FM_tablespec">&#160;</p>

<table cellspacing="0" width="661" class="hcp1">
	<tr style="height: 13.00pt;" bgcolor="#B3B3B3">
		<th width="77" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="74" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Meaning</p></th>
		<th width="46" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">I/O</p></th>
		<th width="264" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Description</p></th>
		<th width="83" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Valid 
		 range</p></th>
		<th width="60" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Unit</p></th>
		<th width="57" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Default</p></th>
	</tr>
	<tr style="height: 51.40pt;">
		<td width="77" class="hcp4"><p 
			 class="FM_tablebody1c9pt">RCMD</p></td>
		<td width="74" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Command name</p></td>
		<td rowspan="3" width="46" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Input</p></td>
		<td width="264" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Received host command name<sup>*1</sup></p></td>
		<td width="83" class="hcp4"><p 
			 class="FM_tablebody1c9pt">81 bytes max. (includ­ing final 
		 NULL)<sup>*2</sup></p></td>
		<td rowspan="3" width="60" class="hcp4"><p 
			 class="FM_tablebody1c9pt">---</p></td>
		<td width="57" class="hcp6"><p class="FM_tablebody1c9pt">---</p></td>
	</tr>
	<tr style="height: 157.00pt;">
		<td width="77" class="hcp4"><p 
			 class="FM_tablebody1c9pt">HCACK</p></td>
		<td width="74" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Host com­mand parameter acknowl­edge 
		 code</p></td>
		<td width="264" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Command accept/reject code</p>
		<p class="FM_tablebody1c9pt">16#00: Acknowledged. Command was exe­cuted.</p>
		<p class="FM_tablebody1c9pt">16#01: Command does not exist.</p>
		<p class="FM_tablebody1c9pt">16#02: Cannot perform now.</p>
		<p class="FM_tablebody1c9pt">16#03: At least one parameter is invalid.</p>
		<p class="FM_tablebody1c9pt">16#04: Acknowledged. Command will 
		 be per­formed with completion signaled later.</p>
		<p class="FM_tablebody1c9pt">16#05: Rejected. Already in desired 
		 condition.</p>
		<p class="FM_tablebody1c9pt">16#06: No such object exists.</p>
		<p class="FM_tablebody1c9pt">16#07 to 16#3F: Reserved.</p></td>
		<td width="83" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#00 to 16#3F</p></td>
		<td width="57" class="hcp6"><p class="FM_tablebody1c9pt">16#00</p></td>
	</tr>
	<tr style="height: 49.00pt;">
		<td width="77" class="hcp4"><p 
			 class="FM_tablebody1c9pt">CPError­Num</p></td>
		<td width="74" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Number of command parameter errors</p></td>
		<td width="264" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Number of command parameters deemed 
		 in error</p></td>
		<td width="83" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Depends on data type.</p></td>
		<td width="57" class="hcp6"><p class="FM_tablebody1c9pt">0</p></td>
	</tr>
</table>


<table width="661" class="hcp9">
	<tr>
		<td><p class="FM_tablebody1c9pt"><sup>*1</sup>It is not necessary 
		 to set an input variable. The PPID from the host command execution 
		 request is input automatically.</p>
		<p class="FM_tablebody1c9pt"><sup>*2</sup>The maximum number of 
		 characters is set on the SECS/GEM Configurator. The maximum number 
		 of bytes is the maxi­mum number of characters including the final 
		 NULL character plus 1.</p></td>
	</tr>
</table>


<table cellspacing="0" width="661" class="hcp1">
	<tr style="height: 37.00pt;" bgcolor="#B3B3B3">
		<th rowspan="2" width="83" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">&#160;</p></th>
		<th width="47" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Bool­ean</p></th>
		<th colspan="4" width="114" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Bit 
		 strings</p></th>
		<th colspan="8" width="223" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Integers</p></th>
		<th colspan="2" width="61" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Real 
		 num­bers</p></th>
		<th colspan="5" width="135" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Times, 
		 durations, dates, and text strings</p></th>
		
	</tr>
	<tr style="height: 43.00pt;" bgcolor="#B3B3B3">
		<th width="47" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">BOOL</p></th>
		<th width="30" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">BYTE</p></th>
		<th width="26" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">WORD</p></th>
		<th width="29" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">DWORD</p></th>
		<th width="29" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">LWORD</p></th>
		<th width="29" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">USINT</p></th>
		<th width="29" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">UINT</p></th>
		<th width="26" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">UDINT</p></th>
		<th width="26" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">ULINT</p></th>
		<th width="30" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">SINT</p></th>
		<th width="30" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">INT</p></th>
		<th width="26" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">DINT</p></th>
		<th width="26" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">LINT</p></th>
		<th width="30" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">REAL</p></th>
		<th width="30" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">LREAL</p></th>
		<th width="27" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">TIME</p></th>
		<th width="27" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">DATE</p></th>
		<th width="27" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">TOD</p></th>
		<th width="27" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">DT</p></th>
		<th width="28" bgcolor="#B3B3B3" class="hcp11"><p class="FM_tabletitlec9pt">STRING</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="83" class="hcp4"><p 
			 class="FM_tablebody1c9pt">RCMD</p></td>
		<td width="47" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="28" class="hcp6"><p class="FM_tablebody1c9pt">OK</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="83" class="hcp4"><p 
			 class="FM_tablebody1c9pt">HCACK</p></td>
		<td width="47" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">OK</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="28" class="hcp6"><p class="FM_tablebody1c9pt">&#160;</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="83" class="hcp4"><p 
			 class="FM_tablebody1c9pt">CPErrorNum</p></td>
		<td width="47" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">OK</p></td>
		<td width="29" class="hcp4"><p 
			 class="FM_tablebody1c9pt">OK</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">OK</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">OK</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="26" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="30" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="27" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="28" class="hcp6"><p class="FM_tablebody1c9pt">&#160;</p></td>
	</tr>
</table>

<p class="FM_CRhead3">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Function</p></td>
	</tr>
</table>

<p class="FM_body1">The GEM_AckHostCmd instruction sends the execution 
 accept/reject result in reply to an execution request for a host command 
 from the host. The following are required for the reply.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Host 
 command parameter acknowledge code</p>
<p class="FM_bul1">The acknowledge tells whether the host command can be 
 executed. The result is based on the fol­lowing checks.</p>
<p class="FM_bul1">a)<span class="hcp12">&#160;&#160;&#160;</span>Is 
 the host command valid?</p>
<p class="FM_bul1">b)<span class="hcp12">&#160;&#160;&#160;</span>Can 
 the host command be executed?</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Number 
 of host command parameter errors</p>
<p class="FM_bul1">This is the number of CPVAL values deemed in error in 
 the host command.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>The 
 following information on the CPVAL values that were deemed to be in error 
 in the host command</p>
<p class="FM_bul1">a)<span class="hcp12">&#160;&#160;&#160;</span>CPNAME 
 of each CPVAL value</p>
<p class="FM_bul1">b)<span class="hcp12">&#160;&#160;&#160;</span>Acknowledge 
 codes of the CPVAL values that were deemed to be in error</p>
<p class="FM_body1">Refer to the application procedure for this instruction 
 for the processing to send a reply with the execu­tion accept/reject result.</p>
<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Additional Information</p></td>
	</tr>
</table>

<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>This 
 instruction uses the Host Command scenario of the GEM Remote Control capability.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>A 
 SECS message is sent if this instruction is executed and execution ends 
 normally. The SECS message exchange between the equipment and host is 
 given below.</p>
<div class="hcp13">
	<img alt="GEM_AckHostCmd_020.jpg" id="image24" src="GEM_AckHostCmd_020.jpg" width="661" height="121" border="0"> 
</div>
<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Related System-defined 
		 Variables</p></td>
	</tr>
</table>


<table cellspacing="0" width="661" class="hcp1">
	<tr style="height: 13.00pt;" bgcolor="#B3B3B3">
		<th width="151" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="151" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Meaning</p></th>
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Data 
		 type</p></th>
		<th width="283" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Description</p></th>
	</tr>
	<tr style="height: 57.40pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">_GEM_BusyHostCmd</p></td>
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Host Command Transac­tion Processing 
		 Flag</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BOOL</p></td>
		<td width="283" class="hcp6"><p class="FM_tablebody1c9pt">Gives 
		 the status of processing a transaction for a host command from 
		 the host.<sup>*1</sup></p>
		<p class="FM_tablebody1c9pt">TRUE: Processing</p>
		<p class="FM_tablebody1c9pt">FALSE: Not processing.</p></td>
	</tr>
	<tr style="height: 55.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">_GEM_InterlockHostCmd</p></td>
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Host Command Interlock</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BOOL</p></td>
		<td width="283" class="hcp6"><p class="FM_tablebody1c9pt">Specifies 
		 whether to prohibit reception of host com­mands from the host.</p>
		<p class="FM_tablebody1c9pt">TRUE: Prohibited.</p>
		<p class="FM_tablebody1c9pt">FALSE: Granted</p></td>
	</tr>
	<tr style="height: 49.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">_GEM_ServiceStatus</p></td>
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">_sGEM_­SER­VICE_STATUS</p></td>
		<td width="283" class="hcp6"><p class="FM_tablebody1c9pt">Gives 
		 the GEM Service status.</p>
		<p class="FM_tablebody1c9pt">Refer to <a href="GEM_SystemVariables.htm#A206_GEM_Service_Status">GEM 
		 Service status</a> for details.</p></td>
	</tr>
</table>


<table width="661" class="hcp9">
	<tr>
		<td><p class="FM_tablebody1c9pt"><sup>*1</sup>This variable changes 
		 to TRUE when Host Command Send (S2,F41) is received. It will change 
		 to FALSE when execution of the instruction is completed normally.</p></td>
	</tr>
</table>

<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Related User-defined 
		 Variables</p></td>
	</tr>
</table>

<p class="FM_head5"><span class="FM_Wingdings">l<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Variables 
 for Host Command Reception</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="151" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="299" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Description</p></th>
		<th width="155" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">SECS/GEM Configurator 
		 setting</p></th>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody19pt">S2,F41: RCMD</p></td>
		<td width="299" class="hcp4"><p 
			 class="FM_tablebody19pt">Stores the RCMD of the host command 
		 received from the host.</p></td>
		<td rowspan="3" width="155" class="hcp6"><p class="FM_tablebody19pt">Host 
		 Command <span class="hcp15">-</span> Opera­tion 
		 settings</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody19pt">S2,F41: Number of CPNAMEs</p></td>
		<td width="299" class="hcp4"><p 
			 class="FM_tablebody19pt">Stores the number of host command 
		 CPNAMEs received from the host.</p></td>
		
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody19pt">S2,F41: CPNAME Table</p></td>
		<td width="299" class="hcp4"><p 
			 class="FM_tablebody19pt">Stores the CPNAMEs of the host command 
		 received from the host.</p></td>
		
	</tr>
	<tr style="height: 37.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody19pt">S2,F41: CPVAL</p></td>
		<td width="299" class="hcp4"><p 
			 class="FM_tablebody19pt">Stores the CPVAL of the host command 
		 CPNAME received from the host. There is a different variable for 
		 each CPNAME.</p></td>
		<td width="155" class="hcp6"><p class="FM_tablebody19pt">Host 
		 commands <span class="hcp15">-</span>&#160;Host 
		 command definition</p></td>
	</tr>
</table>

<p class="FM_head5"><span class="FM_Wingdings">l<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Variables 
 for Host Command Send</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="151" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="299" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Description</p></th>
		<th width="155" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">SECS/GEM Configurator 
		 setting</p></th>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody19pt">S2,F42: Error CPNAME Table</p></td>
		<td width="299" class="hcp4"><p 
			 class="FM_tablebody19pt">Stores the CPNAMEs of the CPVALs 
		 that were deemed to be in error.</p></td>
		<td rowspan="2" width="155" class="hcp6"><p class="FM_tablebody19pt">Host 
		 Command <span class="hcp15">-</span> Opera­tion 
		 settings</p></td>
	</tr>
	<tr style="height: 85.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody19pt">S2,F42: CPACK Table</p></td>
		<td width="299" class="hcp4"><p 
			 class="FM_tablebody19pt">Stores the acknowledge codes of the 
		 CPVAL that were deemed to be in error.</p>
		<p class="FM_tablebody19pt">16#01: Parameter name CPNAME does not 
		 exist.</p>
		<p class="FM_tablebody19pt">16#02: Illegal value specified for 
		 CPVAL.</p>
		<p class="FM_tablebody19pt">16#03: Illegal format specified for 
		 CPVAL.</p>
		<p class="FM_tablebody19pt">16#04 to 16#3F: Other equipment-specific 
		 errors</p></td>
		
	</tr>
</table>

<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Related Error Codes</p></td>
	</tr>
</table>

<p class="FM_tabletitlec9pt">&#160;</p>

<table cellspacing="0" width="661" class="hcp1">
	<tr style="height: 13.00pt;" bgcolor="#B3B3B3">
		<th width="94" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Error 
		 code</p></th>
		<th width="227" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="340" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Description</p></th>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3830</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">HCACK Out of Range</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 value of the <span class="hcp16">HCACK</span>&#160;input 
		 variable is outside of the valid range.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#041D</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Exceeded Simultaneous Instruction 
		 Exe­cuted Resources</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 number of simultaneously executed GEM instructions exceeded the 
		 limit.</p></td>
	</tr>
	<tr style="height: 37.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3821</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Invalid Size</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 value specified in the <span class="hcp16">CPErrorNum</span>&#160;input 
		 variable is larger than the number of array elements in <span class="hcp16">S2,F42: Error CPNAME Table</span>&#160;or 
		 <span class="hcp16">S2,F42: CPACK Table</span>.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#382F</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Illegal CPNAME</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">A 
		 CPNAME specified in <span class="hcp16">S2,F41: 
		 CPNAME Table</span>&#160;is different from a received CPNAME.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3831</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">CPACK Out of Range</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 value in <span class="hcp16">S2,F42: CPACK Table</span>&#160;is 
		 outside of the valid range.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3810</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in Initializing</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was Initializing.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3811</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in EQStarting</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was EQStarting.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3812</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in EQInitializing</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was EQInitializing.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3814</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in Stop</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was Stop.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3815</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in Error</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was Error.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3816</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in ShuttingDown</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was ShuttingDown.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3817</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM Service Status in Shutdown</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when the GEM Service status was Shutdown.</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody1c9pt">16#3818</p></td>
		<td width="227" class="hcp4"><p 
			 class="FM_tablebody1c9pt">No Message Received</p></td>
		<td width="340" class="hcp6"><p class="FM_tablebody1c9pt">The 
		 instruction was executed when a host command was not received.</p></td>
	</tr>
</table>

<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Precautions for Correct 
		 Use</p></td>
	</tr>
</table>

<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Before 
 executing the instruction, confirm that all of the following conditions 
 are met. If the instruction is executed when any of these conditions is 
 not met, an error will occur and <span class="hcp16">Error</span>&#160;will 
 change to TRUE.</p>
<p class="FM_bul1">a)<span class="hcp12">&#160;&#160;&#160;</span><span class="hcp16">_GEM_ServiceStatus</span>&#160;must be 
 <span class="hcp16">EQRun</span>.</p>
<p class="FM_bul1">b)<span class="hcp12">&#160;&#160;&#160;</span><span class="hcp16">_GEM_BusyHostCmd</span> must be TRUE.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>In 
 the following cases, <span class="hcp16">_GEM_BusyHostCmd</span>&#160;does 
 not change to TRUE even if Host Command Send (S2,F41) is received.</p>
<p class="FM_bul1">a)<span class="hcp12">&#160;&#160;&#160;</span>The 
 RCMD received in the host command does not exist in the receivable host 
 commands set on the SECS/GEM Configurator.</p>
<p class="FM_bul1">b)<span class="hcp12">&#160;&#160;&#160;</span>The 
 data type of RCMD, CPNAME, or CPVAL did not agree between the received 
 host com­mand and SECS/GEM Configurator setting.</p>
<p class="FM_bul1">c)<span class="hcp12">&#160;&#160;&#160;</span>The 
 user-defined variable to store RCMD, CPNAME, or CPVA from the received 
 host command does not exist.</p>
<p class="FM_bul1">d)<span class="hcp12">&#160;&#160;&#160;</span><span class="hcp16">_GEM_Interlock_HostCmd</span> is TRUE.</p>
<p class="FM_bul1">e)<span class="hcp12">&#160;&#160;&#160;</span>Host 
 Command Send (S2,F41) is disabled in the message settings on the SECS/GEM 
 Configu­rator.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span><span class="hcp16">S2,F41: CPVAL</span> is not updated if 
 Omit Parameters is enabled on the SECS/GEM Configurator.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Execution 
 of the instruction will not end in an error even if the <span class="hcp16">RCMD</span> 
 input variable specifies a com­mand name that is different from the command 
 name in <span class="hcp16">S2,F41: RCMD</span>.</p>
<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Application Procedure</p></td>
	</tr>
</table>

<p class="FM_body1">Use the following procedure for this instruction.</p>
<p class="FM_list1"><span class="FM_list1num">1<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Detecting 
 Host Command Reception</p>
<p class="FM_listbody1">Confirm that <span class="hcp16">_GEM_BusyHostCmd</span> 
 changes from FALSE to TRUE.</p>
<p class="FM_listbody1">Store the received host command in the following 
 variables.</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>S2,F41: 
 RCMD</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>S2,F41: 
 Number of CPNAMEs</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>S2,F41: 
 CPNAME Table</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>S2,F41: 
 CPVAL</p>
<p class="FM_list1next"><span class="FM_list1num">2<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Determining 
 the Validity of the Host Command and Storing Error Information</p>
<p class="FM_listbody1">Determine if the host command is valid.</p>
<p class="FM_listbody1">Examples of the criteria to determine validity 
 are given below.</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Is 
 the value of <span class="hcp16">S2,F41: CPVAL</span> correct?</p>
<p class="FM_listbody1">If all of the CPVAL values meet the above criteria, 
 the host command parameter acknowledge code is 16#00. If even one of the 
 CPVAL values does not meet the above criteria, the host com­mand parameter 
 acknowledge code is 16#03. Store the error information for CPVAL values 
 that do not meet the criteria as follows:</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Store 
 the CPNAME of the CPVAL in <span class="hcp16">S2,F42: Error 
 CPNAME Table</span>.</p>
<p class="FM_bul3">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>Store 
 the acknowledge code as the accept/reject result in <span class="hcp16">S2,F42: 
 CPACK Table</span>.</p>
<p class="FM_list1next"><span class="FM_list1num">3<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Determining 
 If the Host Command Can Be Executed</p>
<p class="FM_listbody1">If the host command is valid, determine if the 
 host command can be executed.</p>
<p class="FM_listbody1">If it can be executed, the host command parameter 
 acknowledge code is 16#00.</p>
<p class="FM_listbody1">If it cannot be executed, the host command parameter 
 acknowledge code is 16#02.</p>
<p class="FM_list1next"><span class="FM_list1num">4<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Executing 
 Host Command</p>
<p class="FM_listbody1">If the host command can be executed, execute it.</p>
<p class="FM_listbody1">If host command execution completion will be reported 
 as an event to the host after completion of the execution of this instruction, 
 the host command parameter acknowledge code is 16#04.</p>
<p class="FM_listbody1">If a response message will be sent as notification 
 after completion of the execution of this instruction, the host command 
 parameter acknowledge code is 16#00.</p>
<p class="FM_list1next"><span class="FM_list1num">5<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Sending 
 the Host Command Execution Accept/Reject Result</p>
<p class="FM_listbody1">Set the host command parameter acknowledge code 
 from steps 2 to 4 for the <span class="hcp16">HCACK</span>&#160;input 
 variable and execute the instruction. The host command execution accept/reject 
 result is sent to the host.</p>
<p class="FM_body1">The following diagram shows the user program processing 
 and data flow for the application procedure. This diagram shows an example 
 in which the host command START that was received from the host contains 
 an invalid parameter. The CPNAME parameter in the host command START contains 
 the fol­lowing data.</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>PPID</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>LOTID</p>
<p class="FM_bul1">•<span class="hcp12">&#160;&#160;&#160;&#160;</span>MID</p>
<p class="FM_body1">CPNAME is determined to be an invalid parameter because 
 the CPVAL values for LOTID and MID are outside of the valid ranges. Numbers 
 1 to 5 in the diagram indicate the steps in the application proce­dure.</p>
<div class="hcp5">
	<p style="text-align: left;"><img alt="GEM_AckHostCmd_025.jpg" id="image25" src="GEM_AckHostCmd_025.jpg" width="623" height="633" border="0"> </p>
</div>
<p class="FM_body1">&#160;</p>

<table cellspacing="0" width="661" class="hcp7">
	<tr style="height: 20.00pt;" bgcolor="#B3B3B3">
		<td width="661" bgcolor="#B3B3B3" class="hcp8"><p class="FM_CRhead3">Sample Programming</p></td>
	</tr>
</table>

<p class="FM_body1">This sample sends the host command verification 
 results in reply to an execution request for a host command from the host.</p>
<p class="FM_body1">The START host command is used in this example.</p>

<table cellspacing="0" width="620" class="hcp17">
	<tr style="height: 21.00pt;">
		<td width="620" class="hcp18"><p 
			 class="FM_CRhead3">SECS/GEM Configurator</p></td>
	</tr>
</table>

<p class="FM_body1">First, the START host command is defined on the SECS/GEM 
 Configurator.</p>
<p class="FM_body1">Link variables for the operation settings of the host 
 command are registered.</p>

<table cellspacing="0" width="510" class="hcp14">
	<tr style="height: 13.00pt;" bgcolor="#B3B3B3">
		<th width="321" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="189" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Link variable</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="321" class="hcp4"><p 
			 class="FM_tablebody19pt">Link variable for S2F41: RCMD</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody19pt">S2F41_RCMD</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="321" class="hcp4"><p 
			 class="FM_tablebody19pt">Max number of CPNAMEs</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody19pt">3</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="321" class="hcp4"><p 
			 class="FM_tablebody19pt">Link variable for S2F41: CPNAMEs 
		 list - CPNAME Count</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody19pt">S2F41_CPNAME_NUMBER</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="321" class="hcp4"><p 
			 class="FM_tablebody19pt">Link variable for S2F41: CPNAMEs 
		 list - CPNAME Table</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody19pt">S2F41_CPNAME_TABLE</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="321" class="hcp4"><p 
			 class="FM_tablebody19pt">Link variable for S2F42: error CPNAME 
		 table</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody19pt">S2F42_CPNAME_TABLE</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="321" class="hcp4"><p 
			 class="FM_tablebody19pt">Link variable for S2F42: CPACK table</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody19pt">S2F42_CPACK_TABLE</p></td>
	</tr>
</table>

<p class="FM_body1">&#160;</p>
<p class="FM_body1">The settings to register for CPNAME and CPVAL of the 
 START host command on the <span class="hcp16">Host command 
 definition</span> Tab Page are given in the following table.</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 13.00pt;" bgcolor="#B3B3B3">
		<th colspan="3" width="268" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">CPNAME</p></th>
		<th colspan="3" width="336" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">CPVAL</p></th>
		
	</tr>
	<tr style="height: 13.00pt;" bgcolor="#B3B3B3">
		<th width="94" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">Name</p></th>
		<th width="72" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">Omission</p></th>
		<th width="102" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">Order fixed</p></th>
		<th width="87" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">Format</p></th>
		<th width="102" bgcolor="#B3B3B3" class="hcp10"><p class="FM_tabletitlec9pt">Data size</p></th>
		<th width="147" bgcolor="#B3B3B3" class="hcp11"><p 
			 class="FM_tabletitlec9pt">Link variable</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody19pt">PPID</p></td>
		<td width="72" class="hcp4"><p 
			 class="FM_tablebody19pt">ON</p></td>
		<td width="102" class="hcp4"><p 
			 class="FM_tablebody19pt">OFF</p></td>
		<td width="87" class="hcp4"><p 
			 class="FM_tablebody19pt">A</p></td>
		<td width="102" class="hcp4"><p 
			 class="FM_tablebody19pt">80</p></td>
		<td width="147" class="hcp6"><p class="FM_tablebody19pt">S2F41_START_PPID</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody19pt">LOTID</p></td>
		<td width="72" class="hcp4"><p 
			 class="FM_tablebody19pt">ON</p></td>
		<td width="102" class="hcp4"><p 
			 class="FM_tablebody19pt">OFF</p></td>
		<td width="87" class="hcp4"><p 
			 class="FM_tablebody19pt">A</p></td>
		<td width="102" class="hcp4"><p 
			 class="FM_tablebody19pt">16</p></td>
		<td width="147" class="hcp6"><p class="FM_tablebody19pt">S2F41_START_LOTID</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="94" class="hcp4"><p 
			 class="FM_tablebody19pt">MID</p></td>
		<td width="72" class="hcp4"><p 
			 class="FM_tablebody19pt">ON</p></td>
		<td width="102" class="hcp4"><p 
			 class="FM_tablebody19pt">OFF</p></td>
		<td width="87" class="hcp4"><p 
			 class="FM_tablebody19pt">A</p></td>
		<td width="102" class="hcp4"><p 
			 class="FM_tablebody19pt">16</p></td>
		<td width="147" class="hcp6"><p class="FM_tablebody19pt">S2F41_START_MID</p></td>
	</tr>
</table>

<p class="FM_body1">&#160;</p>
<p class="FM_body1">Next, enter the programming on the Sysmac Studio.</p>
<p class="FM_body1">An error will occur in the verification check if the 
 value of CPVAL for PPID, LOTID, or MID is an empty string.</p>

<table cellspacing="0" width="620" class="hcp17">
	<tr style="height: 21.00pt;">
		<td width="620" class="hcp18"><p 
			 class="FM_CRhead3">LD</p></td>
	</tr>
</table>

<p class="FM_tabletitlec9pt">&#160;</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Internal 
		 Variables</p></th>
		<th width="151" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Variable</p></th>
		<th width="113" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Data 
		 type</p></th>
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Initial 
		 value</p></th>
		<th width="189" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Comment</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td rowspan="5" width="76" class="hcp19"><p class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">varHCACK</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BYTE</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Result 
		 acknowledge code</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">varCPErrorNum</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">UINT</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">0</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Number 
		 of errors</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">AckHostCmd_instance</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM_AckHost<br>
		Cmd</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Instance 
		 of GEM_AckHostCmd instruction</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">varCPACK</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BYTE</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Host 
		 command parameter acknowledge code</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">index</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">INT</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">&#160;</p></td>
	</tr>
</table>

<p class="FM_tabletitlec9pt">&#160;</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">External 
		 Variables</p></th>
		<th width="178" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Variable</p></th>
		<th width="351" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Comment</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td rowspan="10" width="76" class="hcp19"><p class="FM_tablebody19pt">&#160;</p></td>
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">_GEM_ServiceStatus</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">GEM 
		 Service status</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">_GEM_BusyHostCmd</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Host 
		 Command Transaction Processing Flag</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_RCMD</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for RCMD of the host command received from the host</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_CPNAME_NUMBER</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for number of CPNAMEs of the host command received from the host</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_CPNAME_TABLE</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPNAME of the host command received from the host</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_START_PPID</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPVAL when CPNAME of START host command is PPID</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_START_LOTID</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPVAL when CPNAME of START host command is LOTID</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_START_MID</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPVAL when CPNAME of START host command is MID</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F42_CPNAME_TABLE</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for number of CPNAMEs deemed to be in error</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F42_CPACK_TABLE</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for number of acknowledge codes deemed to be in error</p></td>
	</tr>
</table>

<p class="FM_body1">&#160;</p>
<div class="hcp13">
	<img alt="GEM_AckHostCmd_040.jpg" id="image26" src="GEM_AckHostCmd_040.jpg" width="661" height="193" border="0"> 
</div>
<p class="FM_fig">&#160;</p>
<p class="FM_head5"><span class="FM_Wingdings">l<span class="hcp12">&#160;&#160;&#160;&#160;&#160;&#160;&#160;</span></span>Contents 
 of Inline ST</p>
<div class="FM_body1l">
	// Verification check 
</div>
<div class="FM_body1l">
	Clear( S2F42_CPNAME_TABLE ); 
</div>
<div class="FM_body1l">
	Clear( S2F42_CPACK_TABLE ); 
</div>
<div class="FM_body1l">
	varCPErrorNum := 0; 
</div>
<div class="FM_body1l">
	varHCACK:=0; 
</div>
<div class="FM_body1l">
	IF( EQascii( S2F41_RCMD, 'START') =TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;IF ( S2F41_CPNAME_NUMBER &lt;&gt; 0 ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Parameter check for START 
	 host command 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;FOR index:=INT#0 TO S2F41_CPNAME_NUMBER-1 
	 BY INT#1 DO 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=0; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_CPNAME_TABLE[index], 'PPID') = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_START_PPID, '') ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=2; &#160;&#160;&#160;&#160;&#160;&#160;// Illegal value specified 
	 for CPVAL. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSIF( 
	 EQascii(S2F41_CPNAME_TABLE[index], 'LOTID') = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_START_LOTID, '') ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=2; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Illegal value specified 
	 for CPVAL. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSIF( 
	 EQascii(S2F41_CPNAME_TABLE[index], 'MID') = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_START_MID, '') ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=2; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Illegal value specified 
	 for CPVAL. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSE 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 := 1; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Parameter name 
	 CPNAME does not exist. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF 
	 (varCPACK &lt;&gt; 0 ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S2F42_CPNAME_TABLE[ 
	 varCPErrorNum ] := S2F41_CPNAME_TABLE[index]; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S2F42_CPACK_TABLE[ 
	 varCPErrorNum ] := varCPACK; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPErrorNum 
	 := varCPErrorNum + 1; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_FOR; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF ( varCPErrorNum &lt;&gt; 
	 0 ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varHCACK 
	 := 3; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// At least one parameter 
	 is invalid. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	ELSE 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;varHCACK:=1; 
</div>
<div class="FM_body1l">
	END_IF; 
</div>
<p class="FM_body1ST">&#160;</p>

<table cellspacing="0" width="620" class="hcp17">
	<tr style="height: 21.00pt;">
		<td width="620" class="hcp18"><p 
			 class="FM_CRhead3">ST</p></td>
	</tr>
</table>

<p class="FM_tabletitlec9pt">&#160;</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Internal 
		 Variables</p></th>
		<th width="151" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Variable</p></th>
		<th width="113" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Data 
		 type</p></th>
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Initial 
		 value</p></th>
		<th width="189" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Comment</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td rowspan="8" width="76" class="hcp8"><p class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">varHCACK</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BYTE</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Result 
		 acknowledge code</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">varCPErrorNum</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">UINT</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">0</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Number 
		 of errors</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">AckHostCmd_instance</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">GEM_AckHost<br>
		Cmd</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Instance 
		 of GEM_AckHostCmd instruction</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">R_TRIG_instance</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">R_TRIG</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Instance 
		 of R_TRIG instruction</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Trigger</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BOOL</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">FALSE</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Flag 
		 for FALSE to TRUE change in <span class="hcp16">_GEM_BusyHostCmd</span></p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">Stage</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">INT</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">0</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Program 
		 execution status</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">varCPACK</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">BYTE</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">Host 
		 command parameter acknowledge code</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="151" class="hcp4"><p 
			 class="FM_tablebody1c9pt">index</p></td>
		<td width="113" class="hcp4"><p 
			 class="FM_tablebody1c9pt">INT</p></td>
		<td width="76" class="hcp4"><p 
			 class="FM_tablebody1c9pt">&#160;</p></td>
		<td width="189" class="hcp6"><p class="FM_tablebody1c9pt">&#160;</p></td>
	</tr>
</table>

<p class="FM_tabletitlec9pt">&#160;</p>

<table cellspacing="0" width="605" class="hcp14">
	<tr style="height: 25.00pt;" bgcolor="#B3B3B3">
		<th width="76" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">External 
		 Variables</p></th>
		<th width="178" bgcolor="#B3B3B3" class="hcp2"><p class="FM_tabletitlec9pt">Variable</p></th>
		<th width="351" bgcolor="#B3B3B3" class="hcp3"><p class="FM_tabletitlec9pt">Comment</p></th>
	</tr>
	<tr style="height: 13.00pt;">
		<td rowspan="10" width="76" class="hcp8"><p class="FM_tablebody19pt">&#160;</p></td>
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">_GEM_ServiceStatus</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">GEM 
		 Service status</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">_GEM_BusyHostCmd</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Host 
		 Command Transaction Processing Flag</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_RCMD</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for RCMD of the host command received from the host</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_CPNAME_NUMBER</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for number of CPNAMEs of the host command received from the host</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_CPNAME_TABLE</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPNAME of the host command received from the host</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_START_PPID</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPVAL when CPNAME of START host command is PPID</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_START_LOTID</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPVAL when CPNAME of START host command is LOTID</p></td>
	</tr>
	<tr style="height: 25.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F41_START_MID</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for CPVAL when CPNAME of START host command is MID</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F42_CPNAME_TABLE</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for number of CPNAMEs deemed to be in error</p></td>
	</tr>
	<tr style="height: 13.00pt;">
		<td width="178" class="hcp4"><p 
			 class="FM_tablebody19pt">S2F42_CPACK_TABLE</p></td>
		<td width="351" class="hcp6"><p class="FM_tablebody19pt">Variable 
		 for number of acknowledge codes deemed to be in error</p></td>
	</tr>
</table>

<p class="FM_body1ST">&#160;</p>
<div class="FM_body1l">
	CASE Stage Of 
</div>
<div class="FM_body1l">
	0: // Notification of reception from host. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;R_TRIG_instance( _GEM_BusyHostCmd, Trigger ); 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;IF( Trigger = TRUE )THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Initialization 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;AckHostCmd_instance( Execute:=FALSE 
	 ); 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Host command verification 
	 check 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( EQascii( S2F41_RCMD, 
	 'START') =TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Stage:=1; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSE 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varHCACK:=1; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPErrorNum 
	 := 0; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;Stage:=2; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	1: // Verification check 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;Clear( S2F42_CPNAME_TABLE ); 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;Clear( S2F42_CPACK_TABLE ); 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;varCPErrorNum := 0; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;varHCACK:=0; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;IF ( S2F41_CPNAME_NUMBER &lt;&gt; 0 ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Parameter check for START 
	 host command 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;FOR index:=INT#0 TO S2F41_CPNAME_NUMBER-1 
	 BY INT#1 DO 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=0; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_CPNAME_TABLE[index], 'PPID') = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_START_PPID, '') ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=2; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Illegal value specified 
	 for CPVAL. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSIF( 
	 EQascii(S2F41_CPNAME_TABLE[index], 'LOTID') = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_START_LOTID, '') ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=2; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Illegal value specified 
	 for CPVAL. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSIF( 
	 EQascii(S2F41_CPNAME_TABLE[index], 'MID') = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF( 
	 EQascii(S2F41_START_MID, '') ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 :=2; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Illegal value specified 
	 for CPVAL. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;ELSE 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPACK 
	 := 1; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// Parameter name 
	 CPNAME does not exist. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF 
	 (varCPACK &lt;&gt; 0 ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S2F42_CPNAME_TABLE[ 
	 varCPErrorNum ] := S2F41_CPNAME_TABLE[index]; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;S2F42_CPACK_TABLE[ 
	 varCPErrorNum ] := varCPACK; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varCPErrorNum 
	 := varCPErrorNum + 1; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
	 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_FOR; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;IF ( varCPErrorNum &lt;&gt; 
	 0 ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;varHCACK 
	 := 3; &#160;&#160;&#160;&#160;&#160;&#160;&#160;// At least one parameter 
	 is invalid. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;Stage := 2; 
</div>
<div class="FM_body1l">
	2: // Reply to host. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;AckHostCmd_instance( Execute:=TRUE, HCACK:=varHCACK, 
	 CPErrorNum:=varCPErrorNum ); 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;IF( AckHostCmd_instance.Done = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;Stage := 10; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;ELSIF( AckHostCmd_instance.Error = TRUE ) THEN 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;// Add error processing as 
	 required. 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;&#160;&#160;&#160;&#160;Stage := 10; 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;END_IF; 
</div>
<div class="FM_body1l">
	10: // End 
</div>
<div class="FM_body1l">
	&#160;&#160;&#160;Stage := 0; 
</div>
<div class="FM_body1l">
	END_CASE;E 
</div>
</body>
</html>
